import { Metadata } from "next";
import { SliceComponentProps, SliceZone } from "@prismicio/react";

// import { createClient } from "@/prismicio";
import { components } from "@/slices";
import { Content } from "@prismicio/client";
const page = {
  "id": "Z1M0OxMAACkAxuq8",
  "uid": null,
  "url": null,
  "type": "homepage",
  "href": "https://suburbia.cdn.prismic.io/api/v2/documents/search?ref=Z2i-XxIAAC4AC__C&q=%5B%5B%3Ad+%3D+at%28document.id%2C+%22Z1M0OxMAACkAxuq8%22%29+%5D%5D",
  "tags": [],
  "first_publication_date": "2024-12-06T17:28:30+0000",
  "last_publication_date": "2024-12-10T19:14:03+0000",
  "slugs": [
    "homepage"
  ],
  "linked_documents": [],
  "lang": "en-us",
  "alternate_languages": [],
  "data": {
    "slices": [
      {
        "variation": "default",
        "version": "initial",
        "items": [],
        "primary": {
          "heading": [
            {
              "type": "heading1",
              "text": "Escape the Cul-de-sac",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "body": [
            {
              "type": "paragraph",
              "text": "Not just a board, your board. Design a board that's as real as the places you take it.",
              "spans": [
                {
                  "start": 18,
                  "end": 22,
                  "type": "em"
                }
              ],
              "direction": "ltr"
            }
          ],
          "button": {
            "link_type": "Web",
            "key": "7dc8b379-e804-4b39-a9a2-f2e60e1712fb",
            "url": "/build",
            "text": "Build Your Board"
          },
          "skateboard_deck_texture": {
            "dimensions": {
              "width": 2056,
              "height": 4096
            },
            "alt": null,
            "copyright": null,
            "url": "https://images.prismic.io/suburbia/Z1NbsZbqstJ98LiA_green-and-navy.png?auto=format,compress",
            "id": "Z1NbsZbqstJ98LiA",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          },
          "skateboard_wheel_texture": {
            "dimensions": {
              "width": 1025,
              "height": 1025
            },
            "alt": null,
            "copyright": null,
            "url": "https://images.prismic.io/suburbia/Z1NbtZbqstJ98LiG_wheel-green.png?auto=format,compress",
            "id": "Z1NbtZbqstJ98LiG",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          },
          "skateboard_truck_color": "#34495E",
          "skateboard_bolt_color": "#34495E"
        },
        "id": "hero$4386f3a5-e925-404d-a630-b512d0e27cf6",
        "slice_type": "hero",
        "slice_label": null
      },
      {
        "variation": "default",
        "version": "initial",
        "items": [],
        "primary": {
          "heading": [
            {
              "type": "heading2",
              "text": "Latest Drop",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "body": [
            {
              "type": "paragraph",
              "text": "Grab our freshest designs before they sell out!",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "product": [
            {
              "skateboard": {
                "id": "Z1TLsBEAAC0ASgxF",
                "type": "skateboard",
                "tags": [],
                "lang": "en-us",
                "slug": "oni-mask",
                "first_publication_date": "2024-12-07T22:26:58+0000",
                "last_publication_date": "2024-12-23T01:31:14+0000",
                "uid": "oni-mask",
                "link_type": "Document",
                "key": "15e63d15-ada4-4233-b756-542dd8734320",
                "isBroken": false
              }
            },
            {
              "skateboard": {
                "id": "Z1Tw-BEAACoASkCk",
                "type": "skateboard",
                "tags": [],
                "lang": "en-us",
                "slug": "pink-drop",
                "first_publication_date": "2024-12-08T01:06:03+0000",
                "last_publication_date": "2024-12-23T01:31:55+0000",
                "uid": "pink-drop",
                "link_type": "Document",
                "key": "c76395ab-6d73-4b35-8f83-75da8f92c6d9",
                "isBroken": false
              }
            },
            {
              "skateboard": {
                "id": "Z1Tw1xEAACwASkBy",
                "type": "skateboard",
                "tags": [],
                "lang": "en-us",
                "slug": "thank-you",
                "first_publication_date": "2024-12-08T01:05:29+0000",
                "last_publication_date": "2024-12-23T01:33:07+0000",
                "uid": "thank-you",
                "link_type": "Document",
                "key": "b606cb05-c7ac-4e99-a56e-0459176b7ec0",
                "isBroken": false
              }
            },
            {
              "skateboard": {
                "id": "Z1TxGxEAAC4ASkDa",
                "type": "skateboard",
                "tags": [],
                "lang": "en-us",
                "slug": "yellow--black",
                "first_publication_date": "2024-12-08T01:06:38+0000",
                "last_publication_date": "2024-12-23T01:33:42+0000",
                "uid": "yellow-and-black",
                "link_type": "Document",
                "key": "cb9f1e49-836c-46ce-a7de-27b894778bdc",
                "isBroken": false
              }
            }
          ]
        },
        "id": "product_grid$4066d8c3-924b-4440-b013-27f4fe24e2cf",
        "slice_type": "product_grid",
        "slice_label": null
      },
      
      {
        "variation": "imageOnLeft",
        "version": "initial",
        "items": [],
        "primary": {
          "theme": "Red",
          "heading": [
            {
              "type": "heading2",
              "text": "Backend Developer",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "body": [
            {
              "type": "paragraph",
              "text": "Built API Portal Revamp with Golang from scratch",
              "spans": [
                {
                  "start": 0,
                  "end": 108,
                  "type": "strong"
                }
              ],
              "direction": "ltr"
            }
          ],
          "button": {
            "link_type": "Web",
            "key": "bf6c3082-d5cb-4df6-8f48-74291e7de089",
            "url": "/NidzamuddinMuzakkiResume2025Jan.pdf",
            "text": "See Details"
          },
          "background_image": {
            "dimensions": {
              "width": 880,
              "height": 1080
            },
            "alt": null,
            "copyright": null,
            // "url": "https://images.prismic.io/suburbia/Z1UNmpbqstJ98M3k_paint-background.png?auto=format,compress",
            "id": "Z1UNmpbqstJ98M3k",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          },
          "foreground_image": {
            "dimensions": {
              "width": 2987,
              "height": 4063
            },
            "alt": null,
            "copyright": null,
            "url": "https://nidzamuddinmuzakki.netlify.com/CNAF.jpg",
            "id": "Z1NboZbqstJ98Lhl",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          }
        },
        "id": "text_and_image$7d6f79fe-2591-4ee2-bb71-0cc9559e04a9",
        "slice_type": "text_and_image",
        "slice_label": null
      },
      {
        "variation": "default",
        "version": "initial",
        "items": [],
        "primary": {
          "theme": "Navy",
          "heading": [
            {
              "type": "heading2",
              "text": "FULLSTACK DEVELOPER",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "body": [
            {
              "type": "paragraph",
              "text": "Adjust Payment and Disbursment, Create Insurance, Employee Management and Manage Blacklist Engine (Golang, Reactjs, MicroService and MicroFrontend)",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "button": {
            "link_type": "Web",
            "url": "/NidzamuddinMuzakkiResume2025Jan.pdf",
            "key": "53f6d146-1001-4a11-8a99-563759f861b7",
            "text": "See Details"
          },
          "background_image": {
            "dimensions": {
              "width": 880,
              "height": 1080
            },
            "alt": null,
            "copyright": null,
            // "url": "https://images.prismic.io/suburbia/Z1UNmpbqstJ98M3k_paint-background.png?auto=format,compress",
            "id": "Z1UNmpbqstJ98M3k",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          },
          "foreground_image": {
            "dimensions": {
              "width": 1846,
              "height": 2362
            },
            "alt": null,
            "copyright": null,
            "url": "https://nidzamuddinmuzakki.netlify.com/wjv9lhl8et6pe7eg2sin.jpg",
            "id": "Z1NbwJbqstJ98LiW",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          }
        },
        "id": "text_and_image$9792550d-2295-46b3-b4a1-eb0ea1cd7722",
        "slice_type": "text_and_image",
        "slice_label": null
      },
      {
        "variation": "imageOnLeft",
        "version": "initial",
        "items": [],
        "primary": {
          "theme": "Blue",
          "heading": [
            {
              "type": "heading2",
              "text": "FULLSTACK DEVELOPER",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "body": [
            {
              "type": "paragraph",
              "text": "Built ANTASENA and Core Bank (Golang, Reactjs, MicroService and MicroFrontend)",
              "spans": [],
              "direction": "ltr"
            }
          ],
          "button": {
            "link_type": "Web",
            "url": "/NidzamuddinMuzakkiResume2025Jan.pdf",

            "key": "96a7bec1-3ad5-45d3-b10a-22e55162309e",
            "text": "See Details"
          },
          "background_image": {
            "dimensions": {
              "width": 880,
              "height": 1080
            },
            "alt": null,
            "copyright": null,
            // "url": "https://images.prismic.io/suburbia/Z1UNmpbqstJ98M3k_paint-background.png?auto=format,compress",
            "id": "Z1UNmpbqstJ98M3k",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          },
          "foreground_image": {
            "dimensions": {
              "width": 3167,
              "height": 3273
            },
            "alt": "PT. Adapro Nusa Data",
            "copyright": "PT. Adapro Nusa Data",
            "url": "https://nidzamuddinmuzakki.netlify.com/adapro2.png",
            "id": "Z1NboJbqstJ98Lhi",
            "edit": {
              "x": 0,
              "y": 0,
              "zoom": 1,
              "background": "transparent"
            }
          }
        },
        "id": "text_and_image$72fad76d-4c40-4f57-8522-512ca77e4697",
        "slice_type": "text_and_image",
        "slice_label": null
      },
      {
        "variation": "default",
        "version": "initial",
        "items": [],
        "primary": {
          "youtube_video_id": "44I29krtxaw"
        },
        "id": "video_block$10c300fc-e9ef-4448-b8c4-23f60044245f",
        "slice_type": "video_block",
        "slice_label": null
      },
      {
        "variation": "default",
        "version": "initial",
        "items": [],
        "primary": {
          "heading": [
            {
              "type": "heading2",
              "text": "The Team",
              "spans": [],
              "direction": "ltr"
            }
          ]
        },
        "id": "team_grid$f0e1fcad-0c16-4507-92db-20639c983714",
        "slice_type": "team_grid",
        "slice_label": null
      }
    ],
    "meta_title": "Nidzamuddin Muzakki",
    "meta_description": "The best skateboards",
    "meta_image": {}
  }
}
export default async function Page() {
  // const client = createClient();
  
  const slices = bundleTextAndImageSlices(page.data.slices);

  return (
    <SliceZone
      slices={slices}
      components={{
        ...components,
        text_and_image_bundle: ({
          slice,
        }: SliceComponentProps<TextAndImageBundleSlice>) => (
          <div>
            <SliceZone slices={slice.slices} components={components} />
          </div>
        ),
      }}
    />
  );
}

export async function generateMetadata(): Promise<Metadata> {
  // const client = createClient();
  // const page = await client.getSingle("homepage");

  return {
    title: page.data.meta_title,
    description: page.data.meta_description,
  };
}

type TextAndImageBundleSlice = {
  id: string;
  slice_type: "text_and_image_bundle";
  slices: Content.TextAndImageSlice[];
};

function bundleTextAndImageSlices(
  slices: any
) {
  const res: (
    | Content.HomepageDocumentDataSlicesSlice
    | TextAndImageBundleSlice
  )[] = [];

  for (const slice of slices) {
    if (slice.slice_type !== "text_and_image") {
      res.push(slice);
      continue;
    }

    const bundle = res.at(-1);
    if (bundle?.slice_type === "text_and_image_bundle") {
      bundle.slices.push(slice);
    } else {
      res.push({
        id: `${slice.id}-bundle`,
        slice_type: "text_and_image_bundle",
        slices: [slice],
      });
    }
  }
  return res;
}
